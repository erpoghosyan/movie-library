{% extends "base.html" %}
{% load crispy_forms_tags %} 

{% block content %}
<div class="movie-entry">
<h2>{{ object.title }}</h2>
<p>by {{ object.author }} | {{ object.date }}</p> 
<p>{{ object.body }}</p>


{% if user.is_authenticated and user == object.author %} 
<p><a href="{% url 'movie_edit' movie.pk %}">Edit</a> |
<a href="{% url 'movie_delete' movie.pk %}">Delete</a></p>
{% endif %}
</div>

<br/><br/>
<hr>
<br/>
{% if user.is_authenticated %}
{% if liked %}
<button type="submit" name="movie_id" value="{{ movie.id }}" class="btn btn-danger
btn-sm">Unlike</button>
{% else %}
<a href="{% url 'like_movie' movie.id %}">
<button type="submit" name="movie_id" value="{{ movie.id }}" class="btn btn-primary
btn-sm">Like</button></a>
{% endif %}
{% else %}
<small><a href="{% url 'login' %}">Login</a>Login to like</small>
{% endif %}
 - {{ total_likes }}
Likes




<hr>
<h4>Comments</h4>
{% for comment in movie.comment_set.all %}
<p>{{ comment.author }} &middot; {{ comment }}</p>
{% if user.is_authenticated and user == comment.author %}
<p><a href="{% url 'comment_edit' comment.pk %}">Edit</a> |
    <a href="{% url 'comment_delete' comment.pk %}">Delete</a></p>
{% endif %}
{% endfor %}
<hr>

{% if user.is_authenticated %}
<h4>Add a comment</h4>
<form action="" method="post">{% csrf_token %}
    {{ form|crispy }}
<button class="btn btn-success ml-2" type="submit">Save</button> </form>
{% endif %}

<p>Back to <a href="{% url 'movie_list' %}">All Movies</a>.</p> 
{% endblock content %}
